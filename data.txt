/*
 * This line should be ignored by the parser
 */

// Global messages
messages
    // Fallback
    f_1|I don't understand that!
    f_2|I don't know that word.
    f_3|What?
    f_4|You're confusing!
    // Talk
    t_1|There's nobody in here.
    t_2|There's no one to talk to.
    // Walk
    w_1|Where?
    w_2|May I know which direction?
    // Dummies
    dummy|Dummy message.
    junk|You are a piece of junk too!
    otherjunk|You are a huge steaming pile of junk, man!
end

// Global actions
actions
    fallback|printr,f_1,f_2,f_3,f_4
    junk|print,junk
    junktest|goto,junk
    talk|printr,t_1,t_2
    walk|printr,w_1,w_2
    quit|quit
    inventory,check inventory,get inventory,inv,check inv,get inv|invlist
end

// Global command groups
group junk
    0|sjmp,0,1,3
    1|print,otherjunk
    2|ret
    3|set,0,true
    4|print,junk
end

// Scene: initial (called upon start-up)
scene initial
    // Messages
    messages
        0|Welcome to the year 1914, situated in the Philippines, a colony of the United States of America. You are currently standing in front of a branch of the Intercontinental Bank, holding a leather briefcase containing thousands of pesos. You were instructed by your manager to deposit a large sum of money to a private account in another bank. What are you going to do now?%n
        1|You are talking to someone now.
        2|You've picked up a rock.%nA person is approaching you from far away, waving.
        3|After waving back, the person ran towards you.%n"Don't you remember me?" He asked.
        4|"You've got to be kidding!" He answered back, taking something from their pockets.
        5|There's no one to talk to anymore. He left!
        6|You picked the rock from the filthy ground.
        7|You've already picked the rock
        8|There's no rock to be picked (yet!).
        9|You've waved back at the person.
        10|You've already waved at that person!
        11|Who are you waving at?
        12|You screamed, "No!"
        13|You've already said no, weirdo.
    end
    
    // Intro
    group $
        print,0
    end
    
    // Actions
    actions
        look,view,see|goto,view
        //look,view,see|print,0
        take rock|print,2
        wave back|print,3
        no|print,4
        dummy|print,dummy
        random|printr,1,2
        combine|printc,1,2,3,4
        walk north, walk n|scene,north
        
        // Global command group test
        junked|goto,junk
        
		// Sample convo
        talk|goto,conversation
        pick rock|goto,pick_rock
        wave|goto,wave
        no|goto,response_no
    end

    // Command group: view
    group view
        // conditional jump, switch #, line if true, line if false
        0|sjmp,1,1,3
        1|print,0
        2|ret
        3|set,1,true
        4|print,dummy
    end

    /*
     * Sample conversation
     */
    group conversation
        if !100
            print,1
            set,99,true
        end
        if !101,100
            print,2
        end
        if !102,101
            print,3
        end
        if !103,102
            print,4
            set,103,true
        end
        if 100,101,102,103
            print,5
        end
    end
    
    group pick_rock
        if 99
            if_inv !rock
                invset,rock,add
                print,6
                set,100,true
            else
                print,7
            end
        else
            print,8
        end
    end
    
    group wave
        if 100
            if !101
                print,9
                set,101,true
            else
                print,10
            end
        else
            print,11
        end
    end
    
    group response_no
        if 100,101
            if !102
                print,12
                set,102,true
            else
                print,13
            end
        else
            printr,t_1,t_2
        end
    end
    
    actions
        rocka|goto,inventory_test
        rockb|goto,inventory_test_inverted
        rockadd|invset,rock,add
        rockrm|invset,rock,rm
    end

    items
        rock|A dirty rock picked from somewhere. Hmm?
        paper|This is a paper
        pen|This is a pen
    end
    
    group inventory_test
        if_inv rock
            print,Rock is in your inventory!
        else
            print,There's no rock!
        end
    end

    group inventory_test_inverted
        if_inv !rock
            print,There's no rock!
        else
            print,Rock is in your inventory!
        end
    end

    actions
        pp|goto,paper_pen
        penadd|invset,pen,add
        penrm|invset,pen,rm
        paperadd|invset,paper,add
        paperrm|invset,paper,rm
    end
    
    group paper_pen
        print,Individual conditions:%n
        if_inv paper
            print,we have paper
        end
        if_inv !paper
            print,no paper here
        end
        if_inv pen
            print,we have a pen
        end
        if_inv !pen
            print,no pen here
        end
        print,%nAND/OR conditions:%n
        if_inv paper,pen
            print,paper AND pen
        end
        if_inv paper;pen
            print,paper OR pen
        end
        if_inv pen,paper
            print,pen AND paper
        end
        if_inv pen;paper
            print,pen OR paper
        end
        print,%nNOT AND conditions:%n
        if_inv !paper,!pen
            print,NOT paper AND NOT pen
        end
        if_inv !pen,!paper
            print,NOT pen AND NOT paper
        end
        print,%nNOT OR conditions:%n
        if_inv !paper;!pen
            print,NOT paper OR NOT pen
        end
        if_inv !pen;!paper
            print,NOT pen OR NOT paper
        end
        print,%nNOT AND HAS conditions:%n
        if_inv !paper,pen
            print,NOT paper AND HAS pen
        end
        if_inv !pen,paper
            print,NOT pen AND HAS paper
        end
        print,%nHAS AND NOT conditions:%n
        if_inv paper,!pen
            print,HAS paper AND NOT pen
        end
        if_inv pen,!paper
            print,HAS pen AND NOT paper
        end
        print,%nNOT OR HAS conditions:%n
        if_inv !paper;pen
            print,NOT paper OR HAS pen
        end
        if_inv !pen;paper
            print,NOT pen OR HAS paper
        end
        print,%nHAS OR NOT conditions:%n
        if_inv paper;!pen
            print,HAS paper OR NOT pen
        end
        if_inv pen;!paper
            print,HAS pen OR NOT paper
        end
    end
    
end

// Scene: north
scene north
    messages
        nothing|There's nothing here.
        nothing2|THERE IS NOTHING! I REPEAT, THERE IS NOTHING!
    end

    actions
        look,view,see|goto,view
        walk south,walk s|scene,initial
    end

    // Command group: view
    group view
        // conditional jump, switch #, line if true, line if false
        0|sjmp,2,1,3
        1|print,nothing2
        2|ret
        3|set,2,true
        4|print,nothing
    end

    // Overriden global command group test: junk
    group junk
        0|print,this is an inline message
        1|print,this message is inline
        2|print,this message is not in the source
        3|print,nothing
        4|print,nothing2
    end
end
